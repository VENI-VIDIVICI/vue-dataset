import{ref as e,computed as t,watch as s,provide as a,nextTick as n,openBlock as r,createElementBlock as l,renderSlot as u,inject as d,toDisplayString as o,createBlock as i,resolveDynamicComponent as c,withCtx as v,Fragment as g,renderList as h,createCommentVNode as f,createElementVNode as p,normalizeClass as w,withModifiers as b}from"vue";var m={show:"Show",entries:"entries",previous:"Previous",next:"Next",showing:"Showing",showingTo:"to",showingOf:"of",showingEntries:"entries"};function P(e){for(const t in e)return!1;return!0}const S={props:{dsData:{type:Array,default:()=>[]},dsFilterFields:{type:Object,default:()=>({})},dsSortby:{type:Array,default:()=>[]},dsSearchIn:{type:Array,default:()=>[]},dsSearchAs:{type:Object,default:()=>({})},dsSortAs:{type:Object,default:()=>({})}},setup(r){const l=e(1),u=e(""),d=e(10),o=e(m),i=e([]),c=e=>{u.value=e},v=async e=>{const t=p.value;d.value=e,await n();const s=p.value;s.length<t.length&&g(s[s.length-1])},g=e=>{l.value=e},h=t((()=>(r.dsData,u.value,r.dsSortby,r.dsFilterFields,r.dsSearchIn,r.dsSearchAs,r.dsSortAs,Date.now()))),f=t((()=>i.value.slice(S.value,y.value))),p=t((()=>function(e,t){const s=[],a=[];let n;if(s.push(1),e<=1)return s;for(let r=t-2;r<=t+2;r++)r<e&&r>1&&s.push(r);s.push(e);for(let r=0;r<s.length;r++)n&&(s[r]-n==2?a.push(n+1):s[r]-n!=1&&a.push("...")),a.push(s[r]),n=s[r];return a}(b.value,l.value))),w=t((()=>i.value.length)),b=t((()=>Math.ceil(w.value/d.value))),S=t((()=>(l.value-1)*d.value)),y=t((()=>l.value*d.value));return s(w,((e,t)=>{g(1)})),s(h,((e,t)=>{let s=[];u.value||r.dsSortby.length||!P(r.dsFilterFields)?(s=r.dsData.map(((e,t)=>({index:t,value:e}))),P(r.dsFilterFields)||(s=function(e,t){for(const s in t)e=e.filter((function(e){const a=e.value;for(const n in a)if(n===s){if("function"==typeof t[s])return t[s](a[n]);if(""===t[s])return!0;if(a[n]===t[s])return!0}return!1}));return e}(s,r.dsFilterFields)),u.value&&(s=s.filter((e=>function(e,t,s,a){a=String(a).toLowerCase();for(const n in s)if(0===e.length||-1!==e.indexOf(n)){const e=String(s[n]).toLowerCase();for(const s in t)if(s===n&&"function"==typeof t[s]){const n=t[s](e,a);if(!0===n)return n}if(e.indexOf(a)>=0)return!0}return!1}(r.dsSearchIn,r.dsSearchAs,e.value,u.value)))),r.dsSortby.length&&s.sort(function(e,t={}){const s=[];let a;const n=e.length;return e=e.map((function(e,t){return"-"===e[0]?(s[t]=-1,e=e.substring(1)):s[t]=1,e})),function(r,l){for(a=0;a<n;a++){const n=e[a],u=t[n]?t[n](r.value[n]):r.value[n],d=t[n]?t[n](l.value[n]):l.value[n];if(u>d)return s[a];if(u<d)return-s[a]}return 0}}(r.dsSortby,r.dsSortAs)),s=s.map((e=>e.index))):s=r.dsData.map(((e,t)=>t)),i.value=s}),{immediate:!0}),a("search",c),a("showEntries",v),a("setActive",g),a("datasetI18n",o),a("dsData",r.dsData),a("dsRows",f),a("dsPages",p),a("dsResultsNumber",w),a("dsPagecount",b),a("dsFrom",S),a("dsTo",y),a("dsPage",l),{dsShowEntries:d,dsResultsNumber:w,dsPage:l,dsPagecount:b,dsFrom:S,dsTo:y,dsRows:f,dsPages:p,search:c,showEntries:v,setActive:g}}};S.render=function(e,t,s,a,n,d){return r(),l("div",null,[u(e.$slots,"default",{ds:{dsShowEntries:a.dsShowEntries,dsResultsNumber:a.dsResultsNumber,dsPage:a.dsPage,dsPagecount:a.dsPagecount,dsFrom:a.dsFrom,dsTo:a.dsTo,dsData:s.dsData,dsRows:a.dsRows,dsPages:a.dsPages}})])};const y={setup(){const e=d("dsResultsNumber"),s=d("dsFrom"),a=d("dsTo"),n=t((()=>0!==e.value?s.value+1:0)),r=t((()=>a.value>=e.value?e.value:a.value));return{datasetI18n:d("datasetI18n"),dsResultsNumber:e,showing:n,showingTo:r}}};y.render=function(e,t,s,a,n,u){return r(),l("div",null,o(a.datasetI18n.showing)+" "+o(a.showing)+" "+o(a.datasetI18n.showingTo)+" "+o(a.showingTo)+" "+o(a.datasetI18n.showingOf)+" "+o(a.dsResultsNumber)+" "+o(a.datasetI18n.showingEntries),1)};const x={props:{tag:{type:String,default:"div"}},setup:()=>({dsData:d("dsData"),dsRows:d("dsRows")})};x.render=function(e,t,s,a,n,d){return r(),i(c(s.tag),null,{default:v((()=>[(r(!0),l(g,null,h(a.dsRows,(t=>u(e.$slots,"default",{row:a.dsData[t],rowIndex:t}))),256)),a.dsRows.length?f("",!0):u(e.$slots,"noDataFound",{key:0})])),_:3})};const I={setup(){const s=e("..."),a=d("dsPage"),n=d("dsPagecount"),r=t((()=>1===a.value)),l=t((()=>a.value===n.value||0===n.value));return{datasetI18n:d("datasetI18n"),setActive:d("setActive"),dsPages:d("dsPages"),dsPagecount:n,dsPage:a,morePages:s,disabledPrevious:r,disabledNext:l}}},D={class:"pagination"},A=["tabindex","aria-disabled"],N=["onClick"],F={key:1,class:"page-link"},R=["tabindex","aria-disabled"];I.render=function(e,t,s,a,n,u){return r(),l("ul",D,[p("li",{class:w(["page-item",a.disabledPrevious&&"disabled"])},[p("a",{class:"page-link",href:"#",tabindex:a.disabledPrevious?"-1":null,"aria-disabled":a.disabledPrevious?"true":null,onClick:t[0]||(t[0]=b((e=>a.setActive(1!==a.dsPage&&0!==a.dsPagecount?a.dsPage-1:a.dsPage)),["prevent"]))},o(a.datasetI18n.previous),9,A)],2),(r(!0),l(g,null,h(a.dsPages,((e,t)=>(r(),l("li",{key:t,class:w(["page-item",e===a.dsPage&&"active",e===a.morePages&&"disabled"])},[e!==a.morePages?(r(),l("a",{key:0,class:"page-link",href:"#",onClick:b((t=>a.setActive(e)),["prevent"])},o(e),9,N)):(r(),l("span",F,o(e),1))],2)))),128)),p("li",{class:w(["page-item",a.disabledNext&&"disabled"])},[p("a",{class:"page-link",href:"#",tabindex:a.disabledNext?"-1":null,"aria-disabled":a.disabledNext?"true":null,onClick:t[1]||(t[1]=b((e=>a.setActive(a.dsPage!==a.dsPagecount&&0!==a.dsPagecount?a.dsPage+1:a.dsPage)),["prevent"]))},o(a.datasetI18n.next),9,R)],2)])};const k={props:{dsSearchPlaceholder:{type:String,default:""},wait:{type:Number,default:0}},setup(t){const s=d("search");return{dsSearch:e(""),input:function(e,t,s){let a;return function(){const n=this,r=arguments;clearTimeout(a),s&&!a&&e.apply(n,r),a=setTimeout((function(){a=null,s||e.apply(n,r)}),t)}}((e=>{s(e)}),t.wait)}}},E=["placeholder","value"];k.render=function(e,t,s,a,n,u){return r(),l("input",{type:"text",placeholder:s.dsSearchPlaceholder,class:"form-control",value:a.dsSearch,onInput:t[0]||(t[0]=e=>a.input(e.target.value))},null,40,E)};const T={props:{dsShowEntries:{type:Number,default:10},dsShowEntriesLovs:{type:Array,default:()=>[{value:5,text:5},{value:10,text:10},{value:25,text:25},{value:50,text:50},{value:100,text:100}]}},emits:["changed"],setup(e,{emit:t}){const s=d("showEntries");return s(Number(e.dsShowEntries)),{datasetI18n:d("datasetI18n"),change:e=>{t("changed",Number(e.target.value)),s(Number(e.target.value))}}}},C={class:"form-inline"},O=["value"],L=["value"];T.render=function(e,t,s,a,n,u){return r(),l("div",C,[p("label",null,o(a.datasetI18n.show),1),p("select",{value:s.dsShowEntries,class:"form-control mr-1 ml-1",onChange:t[0]||(t[0]=(...e)=>a.change&&a.change(...e))},[(r(!0),l(g,null,h(s.dsShowEntriesLovs,(e=>(r(),l("option",{key:e.value,value:e.value},o(e.text),9,L)))),128))],40,O),p("label",null,o(a.datasetI18n.entries),1)])};export{S as Dataset,y as DatasetInfo,x as DatasetItem,I as DatasetPager,k as DatasetSearch,T as DatasetShow};
